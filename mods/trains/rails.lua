local rail_node_box = {
    type = "connected",
    connect_sides = {"front", "left", "back", "right"},
    --All box points start in the lower left corner, to upper right
    fixed = {
      --Base layer
       {-0.252, -0.5, -0.252, 0.244, -0.438, 0.244},
       --Railties Lower Left
       {-0.19, -0.438, -0.128, -0.128, -0.376, -0.066},
       {-0.128, -0.438, -0.19, -0.066, -0.376, -0.066},
       --Railties Top Left
       {-0.19, -0.438, 0.058, -0.128, -0.376, 0.12},
       {-0.128, -0.438, 0.058, -0.066, -0.376, 0.182},
       --Railties Lower Right
       {0.058, -0.438, -0.19, 0.12, -0.376, -0.066},
       {0.12, -0.438, -0.128, 0.182, -0.376, -0.066},
       --Railties Top Right
       {0.058, -0.438, 0.058, 0.12, -0.376, 0.182},
       {0.12, -0.438, 0.058, 0.182, -0.376, 0.12},
       --Rails
       {-0.128, -0.376, -0.128, -0.066, -0.314, -0.066},
       {-0.128, -0.376, 0.058, -0.066, -0.314, 0.12},
       {-0.066, -0.376, -0.066, 0.058, -0.314, 0.058},
       {0.058, -0.376, -0.128, 0.12, -0.314, -0.066},
       {0.058, -0.376, 0.058, 0.12, -0.314, 0.12}
    },
    connect_front = {
      --Base
      {-0.252, -0.5, -0.5, 0.244, -0.438, -0.252},
      --Railties
      {-0.19, -0.438, -0.438, 0.182, -0.376, -0.376},
      {-0.19, -0.438, -0.252, 0.182, -0.376, -0.19},
      {-0.066, -0.438, -0.128, 0.058, -0.376, -0.066},
      --Rails
      {-0.128, -0.376, -0.5, -0.066, -0.314, -0.128},
      {-0.128, -0.376, -0.066, -0.066, -0.314, -0.004},
      {0.058, -0.376, -0.5, 0.12, -0.314, -0.128},
      {0.058, -0.376, -0.066, 0.12, -0.314, -0.004,}
    },
    connect_left = {
      --Base
      {-0.5, -0.5, -0.252, -0.252, -0.438, 0.244},
      --Railties
      {-0.438, -0.438, -0.19, -0.376, -0.376, 0.182},
      {-0.252, -0.438, -0.19, -0.12, -0.376, 0.182},
      {-0.128, -0.438, -0.066, -0.066, -0.376, 0.058},
      --Rails
      {-0.5, -0.376, -0.128, -0.128, -0.314, -0.066},
      {-0.066, -0.376, -0.128, -0.004, -0.314, -0.066},
      {-0.5, -0.376, 0.058, -0.128, -0.314, 0.12},
      {-0.066, -0.376, 0.058, -0.004, -0.314, 0.12}
    },
    connect_back = {
      --Base
      {-0.252, -0.5, 0.244, 0.244, -0.438, 0.492},
      --Railties
      {-0.066, -0.438, 0.058, 0.058, -0.376, 0.12},
      {-0.19, -0.438, 0.182, 0.182, -0.376, 0.244},
      {-0.19, -0.438, 0.368, 0.182, -0.376, 0.43},
      --Rails
      {-0.128, -0.376, -0.004, -0.066, -0.314, 0.058},
      {-0.128, -0.376, 0.12, -0.066, -0.314, 0.492},
      {0.058, -0.376, -0.004, 0.12, -0.314, 0.058},
      {0.058, -0.376, 0.12, 0.12, -0.314, 0.492}
    },
    connect_right = {
      --Base
      {0.244, -0.5, -0.252, 0.492, -0.438, 0.244},
      --Railties
      {0.058, -0.438, -0.066, 0.12, -0.376, 0.058},
      {0.182, -0.438, -0.19, 0.244, -0.376, 0.182},
      {0.368, -0.438, -0.19, 0.43, -0.376, 0.182},
      --Rails
      {-0.004, -0.376, -0.128, 0.058, -0.314, -0.066},
      {0.12, -0.376, -0.128, 0.492, -0.314, -0.066},
      {-0.004, -0.376, 0.058, 0.058, -0.314, 0.12},
      {0.12, -0.376, 0.058, 0.492, -0.314, 0.12}
    }
}

local rail_collision_box = {
    fixed = {
      --Base layer
       {-0.252, -0.5, -0.252, 0.244, -0.438, 0.244},
       --Railties Lower Left
       {-0.19, -0.438, -0.128, -0.128, -0.376, -0.066},
       {-0.128, -0.438, -0.19, -0.066, -0.376, -0.066},
       --Railties Top Left
       {-0.19, -0.438, 0.058, -0.128, -0.376, 0.12},
       {-0.128, -0.438, 0.058, -0.066, -0.376, 0.182},
       --Railties Lower Right
       {0.058, -0.438, -0.19, 0.12, -0.376, -0.066},
       {0.12, -0.438, -0.128, 0.182, -0.376, -0.066},
       --Railties Top Right
       {0.058, -0.438, 0.058, 0.12, -0.376, 0.182},
       {0.12, -0.438, 0.058, 0.182, -0.376, 0.12},
       --Rails
       {-0.128, -0.376, -0.128, -0.066, -0.314, -0.066},
       {-0.128, -0.376, 0.058, -0.066, -0.314, 0.12},
       {-0.066, -0.376, -0.066, 0.058, -0.314, 0.058},
       {0.058, -0.376, -0.128, 0.12, -0.314, -0.066},
       {0.058, -0.376, 0.058, 0.12, -0.314, 0.12}
    },
    connect_front = {
      --Base
      {-0.252, -0.5, -0.5, 0.244, -0.438, -0.252},
      --Railties
      {-0.19, -0.438, -0.438, 0.182, -0.376, -0.376},
      {-0.19, -0.438, -0.252, 0.182, -0.376, -0.19},
      {-0.066, -0.438, -0.128, 0.058, -0.376, -0.066},
      --Rails
      {-0.128, -0.376, -0.5, -0.066, -0.314, -0.128},
      {-0.128, -0.376, -0.066, -0.066, -0.314, -0.004},
      {0.058, -0.376, -0.5, 0.12, -0.314, -0.128},
      {0.058, -0.376, -0.066, 0.12, -0.004, -0.314}
    },
    connect_left = {
      --Base
      {-0.5, -0.5, -0.252, -0.252, -0.438, 0.244},
      --Railties
      {-0.438, -0.438, -0.19, -0.376, -0.376, 0.182},
      {-0.252, -0.438, -0.19, -0.12, -0.376, 0.182},
      {-0.128, -0.438, -0.066, -0.066, -0.376, 0.058},
      --Rails
      {-0.5, -0.376, -0.128, -0.128, -0.314, -0.066},
      {-0.066, -0.376, -0.128, -0.004, -0.314, -0.066},
      {-0.5, -0.376, 0.058, -0.128, -0.314, 0.12},
      {-0.066, -0.376, 0.058, -0.004, -0.314, 0.12}
    },
    connect_back = {
      --Base
      {-0.252, -0.5, 0.244, 0.244, -0.438, 0.492},
      --Railties
      {-0.066, 0.058, -0.438, 0.058, -0.376, 0.12},
      {-0.19, -0.438, 0.182, 0.182, -0.376, 0.244},
      {-0.19, -0.438, 0.368, 0.182, -0.376, 0.43},
      --Rails
      {-0.128, -0.376, -0.004, -0.066, -0.314, 0.058},
      {-0.128, -0.376, 0.12, -0.066, -0.314, 0.492},
      {0.058, -0.004, -0.376, 0.12, -0.314, 0.058},
      {0.058, -0.376, 0.12, 0.12, -0.314, 0.492}
    },
    connect_right = {
      --Base
      {0.244, -0.5, -0.252, 0.492, -0.438, 0.244},
      --Railties
      {0.058, -0.438, -0.066, 0.12, -0.376, 0.058},
      {0.182, -0.438, -0.19, 0.244, -0.376, 0.182},
      {0.368, -0.438, -0.19, 0.43, -0.376, 0.182},
      --Rails
      {-0.004, -0.376, -0.128, 0.058, -0.314, -0.066},
      {0.12, -0.376, -0.128, 0.492, -0.314, -0.066},
      {-0.004, -0.376, 0.058, 0.058, -0.314, 0.12},
      {0.12, -0.376, 0.058, 0.492, -0.314, 0.12}
    }
}

trains:register_rail("trains:rail", {
   description = ("Rail: For trains."),
   drawtype = "nodebox",
   paramtype = "light",
   use_texture_alpha = "clip",
   groups = {dig_immediate=2, new=1, rail=1},
   tiles = {
      "train_new_top.png",
      "train_new_bottom.png",
      "train_new_side.png",
      "train_new_side.png",
      "train_new_side.png",
      "train_new_side.png"
   },
   node_box = rail_node_box,
   collision_box = rail_collision_box,
   connects_to = {"group:new", "group:structures"},
}, {})

trains:register_rail("trains:brake_rail", {
   description = ("Brake Rail: Reduces the speed of a train."),
   drawtype = "nodebox",
   paramtype = "light",
   use_texture_alpha = "clip",
   groups = {dig_immediate=2, new=1, rail=1},
   tiles = {
      "train_new_top_brake.png",
      "train_new_bottom.png",
      "train_new_side.png",
      "train_new_side.png",
      "train_new_side.png",
      "train_new_side.png"
   },
   node_box = rail_node_box,
   collision_box = rail_collision_box,
   connects_to = {"group:new", "group:structures"},
}, {acceleration = -3})

trains:register_rail("trains:power_rail", {
   description = ("Powered Rail: Increases the speed of a train."),
   drawtype = "nodebox",
   paramtype = "light",
   use_texture_alpha = "clip",
   groups = {dig_immediate=2, new=1, rail=1},
   tiles = {
      "train_new_top_power.png",
      "train_new_bottom.png",
      "train_new_side.png",
      "train_new_side.png",
      "train_new_side.png",
      "train_new_side.png"
   },
   node_box = rail_node_box,
   collision_box = rail_collision_box,
   connects_to = {"group:new", "group:structures"},
}, {acceleration = 3})
